<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø± - ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
    * {
      box-sizing: border-box;
    }

    ::selection {
      background-color: gray;
    }

    body {
      margin: 0;
      font-family: "Tajawal", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background-color: #000;
      color: #fff;
    }

    /* ===== Ø§Ù„Ø®Ù„ÙÙŠØ© ÙˆØ§Ù„ÙƒØ§Ø±Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ ===== */
    .hero {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 2rem 1rem;
      background:
        linear-gradient(to bottom, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.8)),
        url("https://i.postimg.cc/RVdVFtz0/hero.png") center center / cover no-repeat;
      /* Ø§Ù†Øª ÙƒÙ†Øª Ø­Ø§Ø·Ø· Ø§Ù„Ø®Ù„ÙÙŠØ© Ø®Ù„Ø§ØµØŒ ÙØ¶Ù‘Ù„ Ù†ÙØ³ Ø§Ù„Ø±Ø§Ø¨Ø· Ù‡Ù†Ø§ */
    }

    .hero-card {
      width: min(1100px, 100%);
      display: flex;
      gap: 2rem;
      padding: 2.5rem 2rem;
      border-radius: 24px;
      background: rgba(0, 0, 0, 0.35);
      backdrop-filter: blur(18px);
      -webkit-backdrop-filter: blur(18px);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.7);
    }

    .hero-left,
    .hero-right {
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    .hero-left {
      justify-content: center;
      align-items: center;
    }

    /* ===== Ø¬Ø²Ø¡ Ø§Ù„ØªØ±Ø­ÙŠØ¨ ===== */
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.25rem 0.8rem;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.25);
      font-size: 0.85rem;
      margin-bottom: 1rem;
      color: #e0e0e0;
    }

    .badge-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #1e90ff;
    }

    .hero-title {
      font-size: 2.2rem;
      margin: 0 0 0.5rem;
    }

    .hero-emoji {
      margin-inline-start: 0.25rem;
    }

    .hero-subtitle {
      font-size: 1rem;
      color: #e0e0e0;
      margin: 0 0 1.5rem;
      line-height: 1.8;
    }

    .hero-footer {
      margin-top: auto;
      font-size: 0.85rem;
      color: #cccccc;
    }

    /* ===== ÙÙˆØ±Ù… Ø§Ù„Ù„ÙˆØ¬ÙŠÙ† (Ù†ÙØ³ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø¨ØªØ§Ø¹Ùƒ) ===== */
    .login-container {
      margin: 0 auto;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
    }

    .login-form {
      width: 100%;
      max-width: 400px;
      height: 400px;
      background-image: linear-gradient(to bottom, #424242, #212121);
      display: flex;
      align-items: center;
      flex-direction: column;
      border-radius: 0.5rem;
    }

    .login-title {
      color: wheat;
      margin: 3rem 0 1.5rem;
      font-size: 2rem;
    }

    .login-input {
      margin: 0.5rem 0;
      padding: 1rem 0.5rem;
      width: 20rem;
      max-width: 90%;
      background-color: inherit;
      color: wheat;
      border: none;
      outline: none;
      border-bottom: 1px solid wheat;
      transition: all 400ms;
    }

    .login-input::placeholder {
      color: rgba(245, 222, 179, 0.8);
    }

    .login-input:hover {
      background-color: #424242;
      border: none;
      border-radius: 0.5rem;
    }

    .login-btn {
      height: 3rem;
      width: 20rem;
      max-width: 90%;
      margin-top: 2rem;
      background-color: wheat;
      border-radius: 0.5rem;
      border: none;
      font-size: 1.2rem;
      transition: all 400ms;
      cursor: pointer;
      box-shadow:
        0 0 10px antiquewhite,
        0 0 10px antiquewhite;
    }

    .login-btn:hover {
      background-color: antiquewhite;
      box-shadow: none;
    }

    .login-error {
      margin-top: 0.8rem;
      font-size: 0.9rem;
      color: #ff8080;
      min-height: 1.2rem;
    }

    /* ===== Responsive ===== */
    @media (max-width: 900px) {
      .hero-card {
        flex-direction: column-reverse;
        padding: 1.8rem 1.2rem;
      }

      .hero-right {
        text-align: center;
        align-items: center;
      }

      .hero-footer {
        margin-top: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <section class="hero">
    <div class="hero-card">
      <!-- ===== Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„Ø´Ù…Ø§Ù„: Ø§Ù„Ù„ÙˆØ¬ÙŠÙ† ÙÙŠ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø²Ø±Ù‚ ===== -->
      <div class="hero-left">
        <div class="login-container">
          <form class="login-form" id="login-form">
            <p class="login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</p>
            <input
              placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…"
              class="login-input"
              type="text"
              name="username"
              id="username"
              autocomplete="username"
              required
            />
            <input
              placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±"
              class="login-input"
              type="password"
              name="password"
              id="password"
              autocomplete="current-password"
              required
            />
            <button class="login-btn" type="submit">Ø¯Ø®ÙˆÙ„</button>
            <p class="login-error" id="login-error"></p>
          </form>
        </div>
      </div>

      <!-- ===== Ø§Ù„Ø¬Ø²Ø¡ Ø§Ù„ÙŠÙ…ÙŠÙ†: Ø§Ù„ØªØ±Ø­ÙŠØ¨ ===== -->
      <div class="hero-right">
        <div class="badge">
          <span class="badge-dot"></span>
          <span>Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø± â€” Ø§Ù„ÙˆØµÙˆÙ„ Ø§Ù„Ø¢Ù…Ù†</span>
        </div>

        <h1 class="hero-title">
          Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ <span class="hero-emoji">ğŸ‘‹</span>
        </h1>

        <p class="hero-subtitle">
          Ø³ÙŠÙØ³Ø¬Ù‘ÙÙ„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ØªØµØ§Ø±ÙŠØ­ØŒ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ ÙˆØªÙˆÙ„ÙŠØ¯ Ù…Ù„ÙØ§Øª
          <strong>PDF</strong> Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù…ÙˆØ§Ù‚Ø¹ Ø§Ù„Ø¹Ù…Ù„ (Ù†Ø¬Ø±Ø§Ù† ÙˆØ´Ø±ÙˆØ±Ø©) Ø­Ø³Ø¨ ØµÙ„Ø§Ø­ÙŠØ§ØªÙƒ.
        </p>

        <div class="hero-footer">
          Eng. Ahmed El-Basha Â©
        </div>
      </div>
    </div>
  </section>

    <script>
    // ===== Ù…ØµØ¯Ø± Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¨Ø³ÙŠØ· Ù„Ùˆ ptw_users Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ (Ù…Ø«Ù„Ø§Ù‹ Ø¨Ø¹Ø¯ Ù…Ø³Ø­ Ø§Ù„Ù…ØªØµÙØ­) =====
    // ØªÙ‚Ø¯Ø± ØªØ¹Ø¯Ù„ Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ Ø£Ùˆ ØªØ´ÙŠÙ„ Ø§Ù„Ù€ fallback Ø¯Ù‡ Ø¨Ø¹Ø¯ Ù…Ø§ ØªØ·Ù…Ù† Ø¥Ù† ÙƒÙ„ Ø­Ø§Ø¬Ø© Ø´ØºØ§Ù„Ø©.
    const FALLBACK_USERS = {
      "admin": { password: "Admin@123", role: "admin", active: true }
    };

    // Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† ptw_users ÙÙŠ localStorage
    function readStoredUsers() {
      try {
        const raw = localStorage.getItem("ptw_users");
        if (!raw) return [];
        const list = JSON.parse(raw);
        return Array.isArray(list) ? list : [];
      } catch (e) {
        console.error("ptw_users parse error", e);
        return [];
      }
    }

    const form = document.getElementById("login-form");
    const usernameInput = document.getElementById("username");
    const passwordInput = document.getElementById("password");
    const errorBox = document.getElementById("login-error");

    // Ù„Ùˆ Ø­Ø¯ Ø¯Ø§Ø®Ù„ ÙˆØ¹Ù†Ø¯Ù‡ Ø³ÙŠØ´Ù† Ø¬Ø§Ù‡Ø²Ø©ØŒ Ø¯Ø®Ù‘Ù„Ù‡ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙˆØ§Ø¨Ø©
    (function autoRedirectIfLoggedIn() {
      try {
        const stored = localStorage.getItem("aln_session");
        if (!stored) return;
        const session = JSON.parse(stored);
        if (session && session.username && session.role) {
          window.location.href = "portal.html";
        }
      } catch (e) {
        console.warn("Session parse error", e);
      }
    })();

    form.addEventListener("submit", function (e) {
      e.preventDefault();
      errorBox.textContent = "";

      const username = usernameInput.value.trim();
      const password = passwordInput.value;

      if (!username || !password) {
        errorBox.textContent = "Ù…Ù† ÙØ¶Ù„Ùƒ Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±.";
        return;
      }

      // 1) Ù†Ù‚Ø±Ø£ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† ptw_users
           // 1) Ù†Ù‚Ø±Ø£ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† Ù…Ù† ptw_users
      const usersList = readStoredUsers();

      // Ù†Ø­Ø§ÙˆÙ„ Ù†Ù„Ø§Ù‚ÙŠ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
      let foundUser = usersList.find(u => u.username === username);

      // Ù„Ùˆ Ù…Ø´ Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø³ Ù…ÙÙŠÙ‡ÙˆØ´ password
      // Ø³Ø§Ø¹ØªÙ‡Ø§ Ù†Ø±Ø¬Ø¹ Ù„Ù„Ù…ØµØ¯Ø± Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ (Ù…Ø«Ù„Ø§Ù‹ admin)
      if ((!foundUser || !foundUser.password) && FALLBACK_USERS[username]) {
        const fb = FALLBACK_USERS[username];
        foundUser = {
          username,
          password: fb.password,
          role: fb.role,
          active: fb.active ?? true
        };
      }

      // 3) Ù…ÙÙŠØ´ Ù…Ø³ØªØ®Ø¯Ù… Ø®Ø§Ù„Øµ
      if (!foundUser) {
        errorBox.textContent = "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯. Ø¨Ø±Ø¬Ø§Ø¡ Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù….";
        return;
      }

      // 4) Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆÙ‚ÙˆÙ
      if (foundUser.active === false) {
        errorBox.textContent = "Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…ÙˆÙ‚ÙˆÙ. Ø¨Ø±Ø¬Ø§Ø¡ Ù…Ø±Ø§Ø¬Ø¹Ø© Ù…Ø³Ø¤ÙˆÙ„ Ø§Ù„Ù†Ø¸Ø§Ù….";
        return;
      }

      // 5) Ø§Ù„Ø¨Ø§Ø³ÙˆØ±Ø¯ ØºÙ„Ø·
      if (!foundUser.password || foundUser.password !== password) {
        errorBox.textContent = "ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©.";
        return;
      }

      // 6) Ù†Ø¬Ø§Ø­ â€“ Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ù„Ø³Ø© aln_session Ø¨Ù†ÙØ³ Ø§Ù„Ø´ÙƒÙ„ Ø§Ù„Ù‚Ø¯ÙŠÙ…
      const sessionData = {
        username: foundUser.username || username,
        role: foundUser.role || "najran",
        loginTime: new Date().toISOString()
      };

      localStorage.setItem("aln_session", JSON.stringify(sessionData));

      // ØªØ­ÙˆÙŠÙ„ Ù„Ù„Ø¨ÙˆØ§Ø¨Ø©
      window.location.href = "portal.html";
    });
  </script>

  </script>
</body>
</html>
